# 高级功能使用指南

## 📋 目录
1. [智能反问确认功能](#智能反问确认功能)
2. [交互式拖拽分箱功能](#交互式拖拽分箱功能)

---

## 🔍 智能反问确认功能

### 功能说明
当您输入模糊描述时，系统会自动识别并反问确认，引导您提供更明确的需求。

### 如何触发

#### 方法1：直接输入模糊描述（推荐）

在对话输入框中输入以下类型的模糊描述：

**示例1：坏客户相关**
```
查一下那些坏客户
分析一下高风险客户
看看问题客户
```

**示例2：好客户相关**
```
查询优质客户
看看好客户
分析正常客户
```

**示例3：年龄相关**
```
分析年轻用户
查询年轻人
看看年轻客户
```

**示例4：新用户相关**
```
查一下新用户
分析新客户
看看新注册用户
```

**示例5：完全模糊的查询**
```
查一下
看看
分析一下
帮我看看
```

### 系统响应示例

**您输入**：`查一下那些坏客户`

**系统响应**：
```
❓ 需要确认信息
您的描述可能不够明确，为了准确理解您的需求，请确认以下问题：

请确认"坏客户"的定义标准：
1. 逾期天数超过多少天？（例如：7天、30天、90天）
2. 是否包括历史逾期记录？
3. 是否包括当前逾期状态？

💡 快速选择（点击使用）：
[逾期超过7天的用户]
[逾期超过30天的用户]
[有历史逾期记录的用户]
[当前逾期且逾期天数>7的用户]

或者您可以直接回复更详细的描述，我会根据您的回复重新理解需求。
```

### 操作步骤

1. **输入模糊描述** → 系统自动检测并弹出反问
2. **选择快速建议** → 点击建议按钮，系统自动确认并继续处理
3. **或直接回复** → 输入更详细的描述，系统重新理解需求

### 注意事项

- ✅ 如果您的描述已经包含具体数字或条件（如"逾期超过7天"），系统不会触发反问
- ✅ 您可以直接点击快速建议按钮，也可以输入更详细的描述
- ✅ 系统会记住您的选择，后续类似查询会参考您的定义

---

## 🎯 交互式拖拽分箱功能

### 功能说明
在分箱图表上提供拖拽手柄，您可以手动调整切分点，系统会实时重算坏账率和WOE值，并检查单调性。

### 如何进入

#### 方法1：通过快速建议按钮（最简单）

1. 打开 `workspace.html` 页面
2. 在页面左侧找到**"智能建议"**区域
3. 点击 **"挖掘高风险客群特征"** 按钮
4. 系统自动进入交互式分箱视图

#### 方法2：通过对话输入

在对话输入框中输入以下任一关键词：

```
挖掘特征
特征分析
分箱分析
智能分箱
帮我挖掘高风险客群
对年龄字段进行分箱
分析年龄与借款金额的交叉特征
```

**推荐输入**：
```
帮我挖掘高风险客群，重点关注年龄、收入、借款金额的组合特征
```

#### 方法3：通过顶部模块按钮

1. 点击页面顶部 **"策略挖掘"** 模块按钮
2. 在对话中输入分箱相关需求

### 功能界面说明

进入分箱视图后，您会看到：

#### 1. 控制面板（顶部）
- **特征名称**：下拉选择（年龄、月收入、入网时长、借款金额）
- **分箱算法**：下拉选择（卡方分箱、决策树分箱、手动调整）
- **重置按钮**：恢复默认分箱
- **应用分箱按钮**：保存当前分箱方案

#### 2. 交互式图表（中间）
- **柱状图**：显示每个分箱的坏账率
- **拖拽手柄**：每个切分点都有可拖拽的圆点（第一个和最后一个除外）
- **实时更新**：拖拽时图表和统计数据实时更新

#### 3. 统计面板（下方）
显示4个关键指标：
- **总IV值**：所有分箱的IV值总和
- **平均坏账率**：加权平均坏账率
- **分箱数量**：当前分箱数量
- **单调性**：✓ 单调 或 ⚠ 非单调

#### 4. 分箱详情表（最下方）
显示每个分箱的详细信息：
- 分箱区间
- 样本占比
- 坏账率
- WOE值
- IV贡献

### 操作步骤

#### 步骤1：进入分箱视图
```
输入：帮我挖掘高风险客群特征
或点击：挖掘高风险客群特征（快速建议按钮）
```

#### 步骤2：查看当前分箱
- 系统自动显示年龄分箱图表
- 查看统计信息和分箱详情

#### 步骤3：调整切分点（可选）
1. **鼠标悬停**：将鼠标移到切分点手柄上，手柄会高亮放大
2. **按住拖拽**：按住鼠标左键，左右拖动手柄
3. **观察变化**：
   - 图表实时重绘
   - 坏账率重新计算
   - WOE值更新
   - IV值变化
   - 单调性检查结果更新
4. **松开鼠标**：完成调整

#### 步骤4：切换特征（可选）
- 在"特征名称"下拉框中选择其他特征
- 系统自动切换并显示新特征的分箱

#### 步骤5：应用分箱方案
- 点击 **"应用分箱"** 按钮
- 系统保存当前方案，可用于策略制定

### 使用示例

**场景：调整年龄分箱**

1. **进入**：输入"挖掘特征"或点击快速建议
2. **查看**：系统显示年龄分箱（18-25, 26-30, 31-35, 36-40, 41-50, 50+）
3. **调整**：
   - 鼠标移到25岁切分点手柄
   - 拖拽到28岁
   - 观察实时更新的统计数据
4. **切换**：下拉选择"月收入"，查看收入分箱
5. **应用**：点击"应用分箱"保存方案

### 功能特性

✅ **拖拽交互**
- 直观的拖拽手柄设计
- 鼠标悬停时手柄放大提示
- 拖拽时显示当前切分点值

✅ **实时计算**
- 拖拽时实时更新坏账率
- 自动计算WOE值和IV值
- 实时检查单调性

✅ **多特征支持**
- 年龄
- 月收入
- 入网时长
- 借款金额

✅ **算法选择**
- 卡方分箱
- 决策树分箱
- 手动调整

### 注意事项

⚠️ **拖拽限制**
- 第一个和最后一个切分点不可拖拽（边界值）
- 拖拽范围有限制，防止无效分箱
- 相邻切分点不能重叠

⚠️ **数据说明**
- 当前使用模拟数据演示
- 实际应用需要连接后端API获取真实数据

⚠️ **单调性**
- 系统检查坏账率是否单调递减
- 非单调分箱会显示警告，但不阻止使用

---

## 🎯 快速入口总结

### 反问确认功能
| 触发方式 | 示例输入 |
|---------|---------|
| 模糊描述 | `查一下那些坏客户` |
| 模糊描述 | `分析一下年轻用户` |
| 模糊描述 | `看看优质客户` |
| 模糊查询 | `查一下` |

### 拖拽分箱功能
| 触发方式 | 操作 |
|---------|------|
| 快速建议 | 点击 **"挖掘高风险客群特征"** 按钮 |
| 对话输入 | 输入 `挖掘特征` 或 `分箱分析` |
| 对话输入 | 输入 `帮我挖掘高风险客群` |
| 模块按钮 | 点击顶部 **"策略挖掘"** 按钮 |

---

## 💡 最佳实践

### 反问确认
1. **明确描述**：尽量包含具体数字和条件，避免触发反问
2. **使用建议**：如果触发反问，优先使用快速建议按钮
3. **详细回复**：也可以直接输入更详细的描述

### 拖拽分箱
1. **先查看**：进入分箱视图后，先查看当前分箱效果
2. **小步调整**：拖拽时小步调整，观察统计数据变化
3. **检查单调性**：确保分箱满足单调性要求
4. **应用方案**：调整完成后记得点击"应用分箱"

---

## 🐛 常见问题

### Q1: 为什么没有触发反问确认？
**A**: 可能原因：
- 您的描述已经包含具体条件（如数字、比较词）
- 系统认为描述足够明确

**解决**：尝试输入更模糊的描述，如"查一下那些坏客户"

### Q2: 如何进入分箱视图？
**A**: 最简单的方法：
1. 点击页面上的 **"挖掘高风险客群特征"** 快速建议按钮
2. 或在对话中输入 `挖掘特征`

### Q3: 拖拽手柄看不到？
**A**: 可能原因：
- 图表还未加载完成
- 浏览器缩放问题

**解决**：
- 等待1-2秒让图表加载
- 调整浏览器缩放比例
- 刷新页面重试

### Q4: 拖拽后数据没有更新？
**A**: 检查：
- 是否在合理范围内拖拽
- 浏览器控制台是否有错误

**解决**：刷新页面重新进入分箱视图

---

## 📞 技术支持

如有问题，请检查：
1. 浏览器控制台是否有错误信息
2. 网络连接是否正常
3. 页面是否完全加载

---

**文档版本**: V1.0  
**更新日期**: 2026-01-15
